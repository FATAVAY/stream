#!/usr/bin/env zsh
#-----------------------------------------------------------------------------------
# This script is to:
#   1. stop all video stream
#   2. rm all temporary files
#
# Author: Hao Feng (F1)
#
# Init Date:   Dec. 15, 2022
# Last Date:   Mar. 18, 2023
#
# Copyright (c) 2022-, FATAVAY CO., LTD.

#-----------------------------------------------------------------------------------

stop () {
	pid=(`ps -ef | grep "$1" | grep -v grep | awk '{print $2}' `)
	for p ($pid) {
		kill -9 $p
	}
}

mission=(rtsp-simple-server \
             start.http \
             clean.s \
             ffmpeg)

for m in ${mission[@]}; do
    echo "stop $m ..."
    stop $m
done

setopt no_nomatch

echo "rm logs/* ..."
rm -rf logs/* 

echo "rm hls/* ..."
rm -rf hls/* 

echo "rm save/* ..."
rm -rf save/*
